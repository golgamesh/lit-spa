
import { 
    Batch, 
    FetchAdapter, 
    FetchAdapterFactory, 
    HttpClient, 
    IHttpClientOptions, 
    IODataApiHelperOptions, 
    IRohFetchRequestInfo, 
    QueryBuilder, 
    RohFetch, 
    first
} from "./rohfetch";

const CorsProxyHost = "https://corsproxy.io";

export default class WordData {
    constructor(protected _clientOptions: IHttpClientOptions) {

    }

    client: HttpClient;
    data: RohFetch;

    async init() {
        this.client = await FetchAdapterFactory(this._clientOptions);
/*         const helperOptions = <IODataApiHelperOptions> {
            hostUrl: 'https://random-word-api.vercel.app',
            pathname: '/api'
        }; */
        const helperOptions = <IODataApiHelperOptions> {
            hostUrl: 'https://random-word-api.herokuapp.com',
            pathname: '/word',
            onRequestHandler: (requestInfo: IRohFetchRequestInfo) => {
                requestInfo.url = `${CorsProxyHost}?${encodeURIComponent(requestInfo.url)}`;
                return requestInfo;
            },
        };
        this.data = new RohFetch(helperOptions, this.client);
    }

    async fetchRandomWord(maxWordLength?: number): Promise<string> {
        //const words = await this.fetchRandomWords(1);
        //return first(words);

        const words = maxWordLength ? StaticWords.filter(word => word.length <= maxWordLength) : StaticWords;

        const seed = Math.round(Math.random() * 100000);
        const index = seed % words.length;
        return Promise.resolve(words[index]);

    }

    fetchRandomWords(words = 10, length?: number): Promise<string[]> {
        return this.data.req('').param('words', words).param('length', length).get();
    }

}

export async function WordDataFactory(options: IHttpClientOptions): Promise<WordData> {
    const data = new WordData(options);
    await data.init();
    return data;
}

const StaticWords = [
    "version",
    "outer",
    "epicalyx",
    "material",
    "contemporary",
    "polish",
    "frank",
    "ratio",
    "looting",
    "minimize",
    "collect",
    "channel",
    "appearance",
    "service",
    "capital",
    "roar",
    "horoscope",
    "weapon",
    "shave",
    "abolish",
    "fine",
    "net",
    "up",
    "responsibility",
    "pressure",
    "affect",
    "nomination",
    "respect",
    "speculate",
    "preach",
    "club",
    "tempt",
    "front",
    "herd",
    "presidency",
    "hot",
    "deprive",
    "constant",
    "toss",
    "paper",
    "piece",
    "pump",
    "architecture",
    "eyebrow",
    "housewife",
    "breed",
    "satisfied",
    "shell",
    "flat",
    "switch",
    "corner",
    "bargain",
    "lily",
    "forecast",
    "policeman",
    "circumstance",
    "fight",
    "opponent",
    "reckless",
    "feminist",
    "fund",
    "oppose",
    "huge",
    "standard",
    "extend",
    "drink",
    "popular",
    "horse",
    "result",
    "outlet",
    "misery",
    "insure",
    "lineage",
    "hospital",
    "volunteer",
    "rational",
    "candidate",
    "provincial",
    "fault",
    "diet",
    "workshop",
    "retiree",
    "accountant",
    "drum",
    "rack",
    "indication",
    "specimen",
    "place",
    "fitness",
    "ideology",
    "gregarious",
    "looting",
    "tell",
    "stable",
    "remedy",
    "decorative",
    "haircut",
    "hang",
    "attract",
    "good",
    "demonstrate",
    "sigh",
    "cancer",
    "sail",
    "demonstration",
    "exact",
    "beg",
    "queue",
    "agenda",
    "dealer",
    "gesture",
    "water",
    "horseshoe",
    "island",
    "tribe",
    "graduate",
    "coach",
    "top",
    "cope",
    "dilute",
    "suggest",
    "deficit",
    "achieve",
    "soup",
    "constant",
    "disappoint",
    "quit",
    "organize",
    "gossip",
    "plaintiff",
    "end",
    "code",
    "presidency",
    "passive",
    "dressing",
    "summer",
    "sleep",
    "miner",
    "moving",
    "momentum",
    "pier",
    "cook",
    "impound",
    "atmosphere",
    "charismatic",
    "respect",
    "computing",
    "vegetation",
    "edition",
    "breeze",
    "coin",
    "like",
    "result",
    "digress",
    "base",
    "inflation",
    "dragon",
    "skeleton",
    "descent",
    "effect",
    "prosecution",
    "soap",
    "writer",
    "wake",
    "transform",
    "finance",
    "agony",
    "no",
    "hit",
    "sail",
    "disclose",
    "subway",
    "responsible",
    "roof",
    "abridge",
    "session",
    "misery",
    "admit",
    "cope",
    "vision",
    "album",
    "unique",
    "disappoint",
    "gate",
    "capture",
    "do",
    "stimulation",
    "export",
    "contribution",
    "orgy",
    "lunch",
    "wind",
    "bomber",
    "junior",
    "can",
    "slave",
    "symptom",
    "garage",
    "lick",
    "registration",
    "secular",
    "feed",
    "pick",
    "pump",
    "pure",
    "lane",
    "business",
    "bell",
    "organ",
    "mercy",
    "utter",
    "miner",
    "ice",
    "disaster",
    "jaw",
    "emotion",
    "cereal",
    "crosswalk",
    "premium",
    "shame",
    "established",
    "scan",
    "draw",
    "sensitive",
    "negligence",
    "tiptoe",
    "shower",
    "defeat",
    "pest",
    "start",
    "generation",
    "blast",
    "ballet",
    "assault",
    "low",
    "aware",
    "rank",
    "bloodshed",
    "pain",
    "destruction",
    "meaning",
    "do",
    "silver",
    "push",
    "distant",
    "exchange",
    "nose",
    "staff",
    "dream",
    "gallery",
    "critical",
    "owe",
    "devote",
    "qualified",
    "single",
    "dive",
    "banish",
    "slice",
    "tempt",
    "small",
    "dough",
    "debate",
    "planet",
    "size",
    "west",
    "add",
    "sector",
    "we",
    "bounce",
    "father",
    "crop",
    "grandmother",
    "captivate",
    "review",
    "assessment",
    "excavate",
    "advertising",
    "stumble",
    "pan",
    "morning",
    "bedroom",
    "distributor",
    "correspondence",
    "earwax",
    "slab",
    "refrigerator",
    "radio",
    "owl",
    "domination",
    "wood",
    "shiver",
    "certain",
    "thread",
    "reform",
    "reflection",
    "Mars",
    "vote",
    "overeat",
    "commission",
    "lecture",
    "palace",
    "objective",
    "wriggle",
    "date",
    "shiver",
    "spot",
    "beef",
    "neck",
    "vacuum",
    "reign",
    "fan",
    "skate",
    "rumor",
    "alcohol",
    "bomber",
    "nonremittal",
    "suggest",
    "multiply",
    "shoot",
    "leave",
    "compete",
    "surprise",
    "slip",
    "fee",
    "undress",
    "upset",
    "jury",
    "crack",
    "herd",
    "license",
    "brainstorm",
    "meal",
    "still",
    "flesh",
    "space",
    "resort",
    "pain",
    "academy",
    "designer",
    "prey",
    "country",
    "grandfather",
    "return",
    "layout",
    "proper",
    "greeting",
    "cupboard",
    "cooperate",
    "iron",
    "distort",
    "mist",
    "elite",
    "capture",
    "satisfied",
    "royalty",
    "strange",
    "sanctuary",
    "view",
    "vigorous",
    "fine",
    "metal",
    "tablet",
    "square",
    "bother",
    "pillow",
    "forest",
    "wine",
    "elaborate",
    "ladder",
    "equal",
    "voice",
    "comment",
    "sausage",
    "instrument",
    "west",
    "kitchen",
    "staircase",
    "incapable",
    "judicial",
    "girl",
    "wind",
    "equation",
    "asset",
    "attractive",
    "repeat",
    "publicity",
    "cutting",
    "bang",
    "prove",
    "appreciate",
    "triangle",
    "basin",
    "baby",
    "thread",
    "prey",
    "tail",
    "facade",
    "mess",
    "contact",
    "mouse",
    "secure",
    "rocket",
    "is",
    "cane",
    "invisible",
    "gaffe",
    "clean",
    "stubborn",
    "fastidious",
    "herb",
    "patent",
    "nomination",
    "private",
    "anticipation",
    "concept",
    "performance",
    "bride",
    "option",
    "critic",
    "talk",
    "duty",
    "advertise",
    "loyalty",
    "planet",
    "finger",
    "sell",
    "drown",
    "drive",
    "clearance",
    "excitement",
    "ankle",
    "start",
    "settle",
    "responsibility",
    "chemistry",
    "ratio",
    "judge",
    "bubble",
    "joy",
    "circulate",
    "table",
    "energy",
    "marriage",
    "inject",
    "coin",
    "strike",
    "connection",
    "detector",
    "turn",
    "AIDS",
    "height",
    "assumption",
    "layout",
    "prize",
    "pension",
    "root",
    "concrete",
    "path",
    "orgy",
    "bounce",
    "motorist",
    "jump",
    "introduce",
    "rifle",
    "advantage",
    "rotate",
    "strike",
    "sword",
    "cultivate",
    "harm",
    "prevalence",
    "bar",
    "consolidate",
    "unique",
    "characteristic",
    "reader",
    "athlete",
    "mixture",
    "stamp",
    "wake",
    "ballet",
    "tropical",
    "scatter",
    "collection",
    "kid",
    "property",
    "strikebreaker",
    "decade",
    "catalogue",
    "bridge",
    "railcar",
    "mile",
    "average",
    "quarrel",
    "sail",
    "houseplant",
    "price",
    "node",
    "galaxy",
    "blackmail",
    "association",
    "bishop",
    "salon",
    "inquiry",
    "avant-garde",
    "poll",
    "poison",
    "animal",
    "small",
    "meal",
    "trait",
    "reproduce",
    "dollar",
    "morale",
    "nut",
    "crash",
    "dressing",
    "drink",
    "overall",
    "see",
    "mutation",
    "midnight",
    "ensure",
    "mole",
    "implication",
    "relax",
    "coat",
    "dilute",
    "horror",
    "faithful",
    "cold",
    "competence",
    "touch",
    "bark",
    "coerce",
    "rack",
    "judicial",
    "sick",
    "beat",
    "room",
    "thirsty",
    "hope",
    "scenario",
    "grass",
    "treasurer",
    "rent",
    "give",
    "disposition",
    "permission",
    "run",
    "sugar",
    "basic",
    "protest",
    "insurance",
];